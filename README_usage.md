# Отчёт по использованию (Usage)

Краткий отчёт по тестовым прогонам бота: модель, параметры, эффект и расход токенов.

---

## Лог-файлы (автозапись)

### logs/usage.csv

После каждого запроса к OpenAI данные пишутся в **`logs/usage.csv`** (обычный чат бота/CLI и запуски ДЗ через `/homework` или `homework`):

| run_id | datetime | model | temperature | prompt_tokens | completion_tokens | total_tokens |
|--------|----------|-------|-------------|----------------|------------------|--------------|

- Папка `logs/` создаётся автоматически при первом запросе.
- Номер прогона (`run_id`) увеличивается с каждым вызовом (бот, CLI, ДЗ).
- Если модель не поддерживает свой `temperature`, в файл попадёт значение `default`.
- Данные из этого CSV можно копировать в таблицу ниже и дополнять эффектом и стоимостью.

### logs/homework_results.json

Результаты запусков промптов ДЗ (команда `/homework` в боте или `homework` в CLI) сохраняются в **`logs/homework_results.json`**: для каждого запуска — prompt_id, дата/время, usage, распарсенный результат (или raw при ошибке JSON).

---

## Таблица прогонов

| Модель | temperature | max_tokens | № прогона | Эффект (сжатость / креатив) | Токены (вход → выход → всего) | Ориентировочная стоимость |
|--------|-------------|------------|-----------|-----------------------------|--------------------------------|---------------------------|
| *пример* | 0.2 | default | 1 | Сжато, предсказуемо | 150 → 80 → 230 | ~$0.0002 |
| | | | | | | |
| | | | | | | |

**Как заполнять:**
- **Модель** — например `gpt-4o-mini`, `gpt-5-mini-2025-08-07`.
- **temperature** — значение из `config.py` или указанное при тесте (0 = сжатость, 1–2 = креатив); при ограничении модели в файле может быть `default`.
- **max_tokens** — лимит на ответ (`OPENAI_MAX_TOKENS` в config, в API передаётся как `max_completion_tokens`); можно указать `default`, если не задавали.
- **№ прогона** — порядковый номер теста (соответствует `run_id` в `logs/usage.csv`).
- **Эффект** — кратко: сжатость/предсказуемость или креатив/разнообразие.
- **Токены** — из лога бота/CLI, из `logs/usage.csv` или из Usage в кабинете OpenAI (вход / выход / всего).
- **Стоимость** — по [тарифам OpenAI](https://openai.com/api/pricing/) (например, для gpt-4o-mini: input ~$0.15/1M, output ~$0.60/1M токенов).

---

## Скрин Usage или ID запросов

- **OpenAI:** [Usage](https://platform.openai.com/usage) — скриншот страницы с расходом по датам/моделям.
- **Прокси-сервис:** скрин или список ID запросов из кабинета.

Вставьте скрин ниже или приложите файл (например `usage_screenshot.png`):

```
[Здесь: usage_screenshot.png или вставка изображения]
```

---

## Примечания

- **logs/usage.csv** — все запросы (бот, CLI и запуски ДЗ) записываются туда автоматически.
- **logs/homework_results.json** — полные результаты прогонов промптов из `prompts.json` (в т.ч. JSON-ответ модели и usage).
- Токены по каждому ответу пишутся в консольный лог бота: `токены: вход=..., выход=..., всего=...`.
- В CLI счётчик выводится под каждым ответом: `[Токены: вход N, выход M, всего K]`.
- Для точной стоимости используйте данные из раздела Usage в [OpenAI Platform](https://platform.openai.com/usage).
